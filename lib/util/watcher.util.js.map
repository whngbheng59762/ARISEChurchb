{"version":3,"sources":["../../src/util/watcher.util.js"],"names":["watcher","callback","watch","app","ignored","persistent","on","file","stats","undefined","runtimePath","replace","appName","runtimeName","unlink"],"mappings":";;;;;kBAKwBA,O;;AALxB;;;;AACA;;;;AACA;;AACA;;;;;;AAEe,SAASA,OAAT,CAAiBC,QAAjB,EAA2B;;AAEtC,QAAMD,UAAU,mBAASE,KAAT,CAAe,gBAAOC,GAAtB,EAA2B;AACvCC,iBAAS,UAD8B;AAEvCC,oBAAY;AAF2B,KAA3B,CAAhB;;AAKAL,YAAQM,EAAR,CAAW,KAAX,EAAkB,UAACC,IAAD,EAAOC,KAAP,EAAiB;;AAE/B;AACA,YAAIA,SAASC,SAAb,EAAwB;AACpB,4BAAMF,IAAN,EAAY,KAAZ;AACAN,qBAASM,IAAT;AACH;AACJ,KAPD;;AASAP,YAAQM,EAAR,CAAW,QAAX,EAAqB,UAACC,IAAD,EAAOC,KAAP,EAAiB;;AAElC,wBAAMD,IAAN,EAAY,QAAZ;AACAN,iBAASM,IAAT;AACH,KAJD;;AAMAP,YAAQM,EAAR,CAAW,QAAX,EAAqB,UAACC,IAAD,EAAOC,KAAP,EAAiB;;AAElC,YAAME,cAAcH,KAAKI,OAAL,CAAgB,gBAAOC,OAAvB,QAAsC,gBAAOC,WAA7C,OAApB;;AAEA,qBAAGC,MAAH,CAAUJ,WAAV,EAAuB,YAAM;AACzB,4BAAMH,IAAN,EAAY,QAAZ;AACAN,qBAASM,IAAT;AACH,SAHD;AAIH,KARD;AASH","file":"watcher.util.js","sourcesContent":["import chokidar from \"chokidar\";\nimport fs from \"fs\";\nimport {watch as debug} from \"./../util/log.util\";\nimport config from \"./../config/index.config\";\n\nexport default function watcher(callback) {\n\n    const watcher = chokidar.watch(config.app, {\n        ignored: /[\\/\\\\]\\./,\n        persistent: true\n    });\n\n    watcher.on('add', (file, stats) => {\n\n        // 新增文件stats undefined\n        if (stats == undefined) {\n            debug(file, 'add');\n            callback(file);\n        }\n    });\n\n    watcher.on('change', (file, stats) => {\n\n        debug(file, 'change');\n        callback(file);\n    });\n\n    watcher.on('unlink', (file, stats) => {\n\n        const runtimePath = file.replace(`${config.appName}/`, `${config.runtimeName}/`);\n\n        fs.unlink(runtimePath, () => {\n            debug(file, 'unlink');\n            callback(file);\n        });\n    });\n}"]}