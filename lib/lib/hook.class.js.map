{"version":3,"sources":["../../src/lib/hook.class.js"],"names":["hooks","name","action","add","key","push","get","path","test","runFunction","runAction","value","eval"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGI,sBAAc;AAAA;;AACV,aAAKA,KAAL,GAAa,EAAb;AACH;;;;8BAEK;AACF,mBAAO,KAAKA,KAAZ;AACH;;;4BAEGC,I,EAAMC,M,EAAQ;AACd,gBAAIC,MAAM,IAAV;AACA,iBAAK,IAAIC,GAAT,IAAgB,KAAKJ,KAArB,EAA4B;AACxB,oBAAIC,QAAQG,GAAZ,EAAiB;AACb,yBAAKJ,KAAL,CAAWI,GAAX,EAAgBC,IAAhB,CAAqBH,MAArB;AACAC,0BAAM,KAAN;AACH;AACJ;AACD,gBAAIA,GAAJ,EAAS;AACL,qBAAKH,KAAL,CAAWC,IAAX,IAAmB,CAACC,MAAD,CAAnB;AACH;;AAED,mBAAO,KAAKI,GAAL,EAAP;AACH;;;;mGAESL,I;;;;;;;yEACU,KAAKD,K;;;;;;;;AAAZI,mC;;sCACDH,QAAQG,G;;;;;;;;;uEACS,KAAKJ,KAAL,CAAWI,GAAX,C;;;;;;;;AAARG,oC;;qCACD,aAAaC,IAAb,CAAkBD,IAAlB,C;;;;;AACA,qCAAKE,WAAL,CAAiBF,IAAjB;;;;;;uCAEM,KAAKG,SAAL,CAAeH,IAAf,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;qGAOVA,I;;;;;;uCACN,qBAAUA,IAAV,C;;;;;;;;;;;;;;;;;;oCAGEI,K,EAAO;AACfC,mCAAqBD,KAArB;AACH","file":"hook.class.js","sourcesContent":["import {runAction} from \"./../util/http.util\";\n\n// hooks 定义\n// {\n//     hook1: [\n//         '/admin/index/index'\n//     ]\n// }\n\nexport default class {\n    constructor() {\n        this.hooks = {};\n    }\n\n    get() {\n        return this.hooks;\n    }\n\n    add(name, action) {\n        let add = true;\n        for (let key in this.hooks) {\n            if (name == key) {\n                this.hooks[key].push(action);\n                add = false;\n            }\n        }\n        if (add) {\n            this.hooks[name] = [action];\n        }\n\n        return this.get();\n    }\n\n    async run(name) {\n        for (let key in this.hooks) {\n            if (name == key) {\n                for (let path of this.hooks[key]) {\n                    if (/\\w+\\(.*\\)$/.test(path)) {\n                        this.runFunction(path);\n                    } else {\n                        await this.runAction(path);\n                    }\n                }\n            }\n        }\n    }\n\n    async runAction(path) {\n        await runAction(path);\n    }\n\n    runFunction(value) {\n        eval(`koahub.utils.${value}`);\n    }\n}\n"]}