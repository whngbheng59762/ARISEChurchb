{"version":3,"sources":["../../src/lib/loader.class.js"],"names":["options","loaders","Array","option","concat","loader","dir","resolve","process","cwd","exist","existsSync","files","readdirSync","list","file","statSync","isDirectory","walk","push","root","Error","suffix","prefix","filter","paths","forEach","value","index","name","relative","lastIndexOf","slice","v","i","replace","lib","require","hasOwnProperty","length","default","arr1","arr2","arr","key"],"mappings":"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","file":"loader.class.js","sourcesContent":["import path from \"path\";\nimport fs from \"fs\";\n\nexport default class {\n\n    constructor(options) {\n\n        let loaders = [];\n\n        if (options instanceof Array) {\n            for (let option of options) {\n                loaders = this.concat(loaders, this.loader(option));\n            }\n        } else {\n            loaders = this.loader(options);\n        }\n\n        return loaders;\n    }\n\n    walk(dir) {\n\n        dir = path.resolve(process.cwd(), dir);\n\n        const exist = fs.existsSync(dir);\n        if (!exist) {\n            return;\n        }\n\n        const files = fs.readdirSync(dir);\n        let list = [];\n\n        for (let file of files) {\n            if (fs.statSync(path.resolve(dir, file)).isDirectory()) {\n                list = list.concat(this.walk(path.resolve(dir, file)));\n            } else {\n                list.push(path.resolve(dir, file));\n            }\n        }\n\n        return list;\n    }\n\n    loader(options) {\n\n        if (typeof options == 'undefined') {\n            options = {};\n        }\n\n        let loaders = [];\n        if (typeof options.root !== 'string') {\n            throw Error('root must be specified');\n        }\n\n        options.suffix = options.suffix || '.js';\n        options.prefix = options.prefix || '';\n        options.filter = options.filter || [];\n\n        const paths = this.walk(options.root);\n        if (!paths) {\n            return;\n        }\n\n        paths.forEach(function (value, index) {\n\n            let name = path.relative(options.root, value);\n            if (name.lastIndexOf(options.suffix) != -1) {\n                name = name.slice(0, name.lastIndexOf(options.suffix));\n\n                options.filter.forEach(function (v, i) {\n                    name = name.replace(v, '');\n                });\n\n                name = options.prefix + name;\n                name = name.replace(/\\\\/g, '/');\n\n                let lib = require(value);\n                if (lib.hasOwnProperty('default') && Object.keys(lib).length == 1) {\n                    loaders[name] = lib.default;\n                } else {\n                    loaders[name] = lib;\n                }\n            }\n        });\n\n        return loaders;\n    }\n\n    concat(arr1, arr2) {\n\n        let arr = arr1;\n\n        for (let key in arr2) {\n            arr[key] = arr2[key];\n        }\n\n        return arr;\n    }\n}\n"]}